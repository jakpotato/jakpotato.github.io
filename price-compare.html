<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Smart Deal Calculator (Fixed dropdown)</title>
<style>
  :root {
    --primary: #007bff;
    --primary-dark: #0056b3;
    --green: #28a745;
    --green-dark: #218838;
    --red: #dc3545;
    --red-dark: #c82333;
  }

  * { box-sizing: border-box; }

  body {
    font-family: Arial, sans-serif;
    background: #f7f9fb;
    color: #333;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 2rem;
    margin: 0;
  }

  .container {
    background: white;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    max-width: 540px;
    width: 100%;
  }

  h1 {
    text-align: center;
    font-size: 1.6rem;
    margin-bottom: 1rem;
  }

  label {
    display: block;
    margin-top: 0.9rem;
    font-weight: bold;
  }

  input,
  select {
    padding: 0.6rem;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    font-size: 1rem;
    width: 100%;
    background: white;
  }

  /* Common row used for price/calories and similar two-column groups */
  .row {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.3rem;
    align-items: center;
  }

  /* ensure children can shrink on small screens */
  .row > input,
  .row > select {
    min-width: 0;
    flex: 1;
  }

  /* weight row: make number field larger than the unit select */
  .weight-row {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.3rem;
    align-items: center;
  }

  .weight-row input {
    min-width: 0;
    flex: 1.25; /* larger share */
  }
  .weight-row select {
    min-width: 0;
    flex: 0.75; /* smaller share */
  }

  /* Buttons */
  button {
    width: 100%;
    margin-top: 1.2rem;
    padding: 0.8rem;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 0.5rem;
    font-size: 1.05rem;
    cursor: pointer;
  }
  button:hover { background: var(--primary-dark); }

  /* Overlay styles */
  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    color: white;
    display: none;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 1.1rem;
    padding: 2rem;
    box-sizing: border-box;
    flex-direction: column;
    z-index: 1000;
    overflow-y: auto;
  }
  .overlay h2 { margin-bottom: 1rem; font-size: 1.5rem; }
  .overlay p { margin: 0.6rem 0; }

  .button-row {
    display: flex;
    gap: 1rem;
    margin-top: 1.6rem;
    width: 100%;
    max-width: 380px;
    justify-content: center;
  }

  .overlay button {
    flex: 1;
    padding: 0.75rem;
    border-radius: 0.5rem;
    font-size: 1rem;
    border: none;
    color: white;
  }

  .edit-btn { background: var(--green); }
  .edit-btn:hover { background: var(--green-dark); }
  .clear-btn { background: var(--red); }
  .clear-btn:hover { background: var(--red-dark); }

  .item-section { margin-bottom: 1.8rem; }

  /* Responsive tweaks */
  @media (max-width: 600px) {
    body { padding: 1rem; align-items: stretch; }
    .container { padding: 1rem; border-radius: 0.6rem; box-shadow: none; }
    h1 { font-size: 1.4rem; }
    .overlay { padding: 1.2rem; font-size: 1rem; }
    .overlay h2 { font-size: 1.25rem; }
    .button-row { gap: 0.6rem; max-width: 320px; }
  }

  /* Small polish: make native select arrow visible on some mobiles */
  select { -webkit-appearance: menulist; appearance: menulist; }
</style>
</head>
<body>
  <div class="container">
    <h1>Smart Deal Calculator</h1>

    <div class="item-section">
      <h3>Item 1</h3>
      <label>Price and Calories:</label>
      <div class="row">
        <input type="number" id="price1" step="0.01" placeholder="Price $" />
        <input type="number" id="calories1" step="1" placeholder="Calories" />
      </div>

      <label>Weight:</label>
      <div class="weight-row">
        <input type="number" id="weight1" step="0.01" placeholder="Weight" />
        <select id="unit1">
          <option value="g">grams</option>
          <option value="kg">kilograms</option>
        </select>
      </div>
    </div>

    <div class="item-section">
      <h3>Item 2</h3>
      <label>Price and Calories:</label>
      <div class="row">
        <input type="number" id="price2" step="0.01" placeholder="Price $" />
        <input type="number" id="calories2" step="1" placeholder="Calories" />
      </div>

      <label>Weight:</label>
      <div class="weight-row">
        <input type="number" id="weight2" step="0.01" placeholder="Weight" />
        <select id="unit2">
          <option value="g">grams</option>
          <option value="kg">kilograms</option>
        </select>
      </div>
    </div>

    <button onclick="compareDeals()">Compare</button>
  </div>

  <!-- Overlay -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
    <div id="overlayContent"></div>
    <div class="button-row">
      <button class="edit-btn" onclick="closeOverlay()">Edit</button>
      <button class="clear-btn" onclick="clearAll()">Clear</button>
    </div>
  </div>

<script>
  function compareDeals() {
    const price1 = parseFloat(document.getElementById("price1").value);
    const calories1 = parseFloat(document.getElementById("calories1").value);
    let weight1 = parseFloat(document.getElementById("weight1").value);
    const unit1 = document.getElementById("unit1").value;

    const price2 = parseFloat(document.getElementById("price2").value);
    const calories2 = parseFloat(document.getElementById("calories2").value);
    let weight2 = parseFloat(document.getElementById("weight2").value);
    const unit2 = document.getElementById("unit2").value;

    if (
      !Number.isFinite(price1) ||
      !Number.isFinite(weight1) ||
      !Number.isFinite(calories1) ||
      !Number.isFinite(price2) ||
      !Number.isFinite(weight2) ||
      !Number.isFinite(calories2)
    ) {
      alert("Please enter valid numeric values for all fields.");
      return;
    }

    if (weight1 <= 0 || weight2 <= 0 || calories1 <= 0 || calories2 <= 0) {
      alert("Weight and calories must be greater than zero.");
      return;
    }

    // convert grams to kg if needed
    if (unit1 === "g") weight1 /= 1000;
    if (unit2 === "g") weight2 /= 1000;

    const pricePerKg1 = price1 / weight1;
    const pricePerKg2 = price2 / weight2;
    const pricePerCal1 = price1 / calories1;
    const pricePerCal2 = price2 / calories2;

    const bestByWeight = pricePerKg1 < pricePerKg2 ? "Item 1" : pricePerKg2 < pricePerKg1 ? "Item 2" : "Both";
  const bestByCalories = pricePerCal1 < pricePerCal2 ? "Item 1" : pricePerCal2 < pricePerCal1 ? "Item 2" : "Both";

  // 50/50 normalized overall score
  const minPricePerKg = Math.min(pricePerKg1, pricePerKg2);
  const minPricePerCal = Math.min(pricePerCal1, pricePerCal2);

  const overall1 = ((pricePerKg1 / minPricePerKg) + (pricePerCal1 / minPricePerCal)) / 2;
  const overall2 = ((pricePerKg2 / minPricePerKg) + (pricePerCal2 / minPricePerCal)) / 2;

  let overallBest = "";
  if (overall1 < overall2) overallBest = "Item 1";
  else if (overall2 < overall1) overallBest = "Item 2";
  else overallBest = "Both items are equally good";

    const overlayContent = document.getElementById("overlayContent");
    overlayContent.innerHTML = `
      <h2>Comparison Results</h2>
      <p><strong>Best by price per weight:</strong> ${bestByWeight} ($${pricePerKg1.toFixed(2)}/kg vs $${pricePerKg2.toFixed(2)}/kg)</p>
      <p><strong>Best by price per calorie:</strong> ${bestByCalories} ($${pricePerCal1.toFixed(4)}/cal vs $${pricePerCal2.toFixed(4)}/cal)</p>
      <p><strong>Overall best deal:</strong> ${overallBest}</p>
    `;
    document.getElementById("overlay").style.display = "flex";
  }

  function closeOverlay() {
    document.getElementById("overlay").style.display = "none";
  }

  function clearAll() {
    closeOverlay();
    document.querySelectorAll("input").forEach(i => i.value = "");
    document.querySelectorAll("select").forEach(s => s.selectedIndex = 0);
  }
</script>
</body>
</html>
